---
import type { GetStaticPaths } from "astro";
import Footer from "../../components/Footer.astro";
import NavbarB from "../../components/NavbarB.astro";
import Layout from "../../layouts/Layout.astro";
import RecipeView from "../../components/RecipeView.astro";

export const prerender = false;

// Función para generar las rutas dinámicas
export const getStaticPaths: GetStaticPaths = async () => {
  const response = await fetch('http://localhost:3001/recetas'); // Obtén datos del servidor
  const recetas = await response.json(); // Convierte la respuesta a JSON

  // Genera las rutas dinámicas basadas en el array de recetas
  return recetas.map((recipe) => ({
    params: { id: recipe.id.toString() }, // Asegúrate de que `id` sea una cadena
  }));
};

// Obtén el parámetro `id` desde la URL
const { id } = Astro.params;

// Vuelve a buscar los datos específicos de la receta por `id`
const response = await fetch(`http://localhost:3001/recetas/${id}`);
const receta = await response.json();

const {name, description, ingredients, instructions, image} = receta

---
<Layout>
	<NavbarB />
  <RecipeView name={name} description={description} ingredients={ingredients} instructions={instructions} image={image}/>
  <Footer/>
</Layout>
